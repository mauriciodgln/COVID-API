{"version":3,"sources":["script.js"],"names":["contenedor","document","querySelector","resultado","formulario","paises","ciudades","btnBuscar","inputBuscar","navegacion","navMobile","obtenerDatosPais","fetch","then","json","datos","html","key","Object","entries","innerHTML","addEventListener","obtenerDatosCiudad","pais","value","solicitarDatos","e","preventDefault","consultarAPI","mostrarError","mensaje","divError","createElement","classList","add","setAttribute","appendChild","setTimeout","remove","url","spinner","limpiarHTML","buscarDatos","ciudad","mostrarDatos","confirmed","deaths","updated","respuestaAPI","ubicacion","divResultados","casosConfirmados","muertes","actualizacion","undefined","firstChild","removeChild","spinnerHTML","desplegarMenu","efectoNavMobile","toggle","borrarClases","window","innerWidth","desplegarBuscador"],"mappings":"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","file":"script.js","sourcesContent":["\r\n// Variables\r\n\r\nconst contenedor = document.querySelector('.contenedor');\r\nconst resultado = document.querySelector('.resultado');\r\nconst formulario = document.querySelector('#formulario');\r\nlet paises = document.querySelector('#pais');\r\nlet ciudades = document.querySelector('#ciudad')\r\nconst btnBuscar = document.querySelector('#btnBuscar');\r\nconst inputBuscar = document.querySelector('#buscar');\r\n\r\nconst navegacion = document.querySelector('.navegacion');\r\nconst navMobile = document.querySelector('.nav-mobile');\r\n\r\n// Event Listener\r\n\r\nwindow.addEventListener('load', ()=>{\r\n  obtenerDatosPais();\r\n  formulario.addEventListener('submit', solicitarDatos);\r\n  navMobile.addEventListener('click', desplegarMenu);\r\n  window.addEventListener('resize', borrarClases);\r\n  btnBuscar.addEventListener('click', desplegarBuscador);\r\n});\r\n\r\n// Funciones\r\n\r\n// -- Scripts API -- //\r\n\r\nfunction obtenerDatosPais() {\r\n  // Recoger paises disponibles en la API para mostrarlos en <select>\r\n\r\n  const url = 'https://covid-api.mmediagroup.fr/v1/cases';\r\n  \r\n  fetch(url)\r\n    .then(resultado => resultado.json())\r\n    .then(datos => {\r\n      \r\n      let html = '<option disabled selected value> -- Selecciona el País -- </option>';\r\n      for(const [key] of Object.entries(datos)){\r\n        html += `<option> ${key} </option>`;\r\n      }\r\n      paises.innerHTML = html;\r\n  \r\n    });\r\n\r\n    paises.addEventListener('change', ()=> {\r\n      obtenerDatosCiudad();\r\n    });\r\n}\r\n\r\nfunction obtenerDatosCiudad() {\r\n  // Una vez seleccionado el país, recoger las ciudades\r\n  // y mostrarlas en el segundo <select>\r\n\r\n  const pais = paises.value;\r\n  const url = `https://covid-api.mmediagroup.fr/v1/cases?country=${pais}`;\r\n\r\n  fetch(url)\r\n    .then(resultado => resultado.json())\r\n    .then(datos => {\r\n      \r\n      let html = '';\r\n      for(const [key] of Object.entries(datos)){\r\n        html += `<option> ${key} </option>`;\r\n      }\r\n      ciudades.innerHTML = html;\r\n    });\r\n}\r\n\r\nfunction solicitarDatos(e){\r\n  e.preventDefault();\r\n\r\n  const pais = paises.value;\r\n  if(pais === ''){\r\n    mostrarError('El país es obligatorio');\r\n    return;\r\n  }\r\n  consultarAPI(pais);\r\n}\r\n\r\nfunction mostrarError(mensaje){\r\n  // Mostrar error si no se selecciona un país\r\n\r\n  const error = document.querySelector('#error');\r\n  if(!error){\r\n    const divError = document.createElement('div');\r\n    divError.classList.add('error');\r\n    divError.setAttribute('id', 'error');\r\n    divError.innerHTML = `\r\n      <strong>Error!</strong>\r\n      <p>${mensaje}</p>\r\n    `;\r\n    contenedor.appendChild(divError);\r\n\r\n    setTimeout(() => {\r\n      divError.remove();\r\n    }, 5000);\r\n  }\r\n}\r\n\r\nfunction consultarAPI(pais){\r\n  // Consultar API \r\n\r\n  const url = `https://covid-api.mmediagroup.fr/v1/cases?country=${pais}`;\r\n\r\n  spinner();\r\n\r\n  setTimeout(() => {\r\n\r\n    limpiarHTML();\r\n    fetch(url)\r\n      .then(resultado => resultado.json())\r\n      .then(datos => buscarDatos(datos))\r\n    \r\n  }, 2000);\r\n\r\n\r\n}\r\n\r\nfunction buscarDatos(datos){\r\n  // Recoger datos de la ubicación seleccionada\r\n\r\n  const ciudad = ciudades.value;\r\n  for(const [key, value] of Object.entries(datos)){\r\n    if(ciudad === key) {\r\n      mostrarDatos(key, value);\r\n    }\r\n  }\r\n}\r\n\r\nfunction mostrarDatos(key, value){\r\n  // Mostrar datos en pantalla\r\n\r\n  const { confirmed, deaths, updated } = value;\r\n  const pais = paises.value;\r\n  const respuestaAPI = document.querySelector('#respuestaAPI')\r\n  const ubicacion = document.createElement('p');\r\n  ubicacion.classList.add('datos');\r\n\r\n  if(key === 'All'){\r\n    ubicacion.innerHTML = `Ubicación: ${pais}`;\r\n\r\n  } else {\r\n    ubicacion.innerHTML = `Ubicación: ${key}, ${pais}`;\r\n  }\r\n\r\n  if(!respuestaAPI){\r\n    const divResultados = document.createElement('div');\r\n    divResultados.setAttribute('id', 'respuestaAPI');\r\n\r\n    const casosConfirmados = document.createElement('p');\r\n    casosConfirmados.classList.add('datos');\r\n    casosConfirmados.innerHTML = `Casos confirmados: ${confirmed}`;\r\n\r\n    const muertes = document.createElement('p');\r\n    muertes.classList.add('datos');\r\n    muertes.innerHTML = `Muertes: ${deaths}`;\r\n\r\n    const actualizacion = document.createElement('p');\r\n    actualizacion.classList.add('datos');\r\n\r\n    if(updated === undefined){\r\n      actualizacion.innerHTML = `Ultima actualización: No disponible`;\r\n\r\n    } else {\r\n      actualizacion.innerHTML = `Ultima actualización: ${updated}`;\r\n    }\r\n\r\n    divResultados.appendChild(ubicacion);\r\n    divResultados.appendChild(casosConfirmados);\r\n    divResultados.appendChild(muertes);\r\n    divResultados.appendChild(actualizacion);\r\n\r\n    resultado.appendChild(divResultados);\r\n  }\r\n\r\n}\r\n\r\nfunction limpiarHTML(){\r\n  // Limpia sección 'resultado' cada que se van a mostrar los resultados\r\n\r\n  while(resultado.firstChild){\r\n    resultado.removeChild(resultado.firstChild);\r\n  }\r\n}\r\n\r\nfunction spinner(){\r\n\r\n  limpiarHTML();\r\n  const spinnerHTML = document.createElement('p');\r\n  spinnerHTML.classList.add('datos')\r\n  spinnerHTML.innerHTML = 'Buscando...';\r\n  resultado.appendChild(spinnerHTML);\r\n  \r\n}\r\n\r\n\r\n// -- Scripts página -- //\r\n\r\nfunction desplegarMenu(){\r\n  efectoNavMobile();\r\n  navegacion.classList.toggle('activo')\r\n}\r\n\r\nfunction efectoNavMobile(){\r\n  navMobile.classList.toggle('activo')\r\n}\r\n\r\nfunction borrarClases(){\r\n  // Eliminar clases 'activo' al ser pantalla mayor a 768px\r\n  if(window.innerWidth > 768){\r\n    navegacion.classList.remove('activo');\r\n    navMobile.classList.remove('activo');\r\n    inputBuscar.classList.remove('activo');\r\n  }\r\n}\r\n\r\nfunction desplegarBuscador(e){\r\n  e.preventDefault();\r\n\r\n  if(window.innerWidth < 768){\r\n    inputBuscar.classList.toggle('activo');\r\n  }\r\n}"]}